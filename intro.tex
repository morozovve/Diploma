\section{Введение}
\label{sec:intro} \index{intro}
% \cite{theft_of_funds}.

%% Введение глобальное описание задачи (предметной области)
%% Введение: про события: сложноструктур.
%% Введение: прогнозироване: задачи регрессии / классификации
%% Актуальность (во введении) добавить: почему важно, где применяется, что может дать
%% Актуальность: в большинстве задач события имеют нерегулярную разнородную структуру: числ/катег признаки, текст етц. Хочется уметь прогнозировать вероятность наступления события / прогнозировать число событий в период времени
\subsection{События и сложноструктурированные события} \label{sect:complex_struct_event}
Задачи обработки и прогнозирования потоков событий в огромном количестве встречаются в современном мире. На практике эти задачи можно встретить при прогнозировании таких вещей как цены на бирже, автомобильный траффик, число заказов такси, количество покупок и многих других, то есть практически в любой задаче обработки данных, имеющих временн\textit{у}ю структуру. Поток событий -- упорядоченный по времени набор событий, каждое из которых описывается некоторым набором признаков и имеет временн\textit{у}ю метку. События называются сложноструктурированными, если они имеют сложную (нерегулярную, разнородную) структуру, т.е. эти события описываются  разнородными признаками - числовыми, категориальными, бинарными,  текстовыми. 

Сложная структура обычно возникает в том случае, если необходимо использовать максимальное количество доступной информации, в том числе текстовой. Например, для прогнозирования цен на бирже было бы уместно использовать сообщения в соцсетях, новости и посты в блогах соответствующей тематики. Также, события некоторой тематики происходящие в мире в основном описываются категориальными признаками, такими как ''страна'', ''город'' и другими. Также нередки случаи, когда доступны текстовые описания для таких событий. Эффективное использование всей доступной информации может значительно улучшить качество прогнозирования.

Из определения видно, что временные промежутки между событиями не предполагаются равными. Поскольку для применения большинства существующих методов прогнозирования и анализа временных рядов требуются одинаковые временные интервалы между событиями, нам необходимо уметь производить агрегацию признаков событий по времени. Учитывая, что значения признаков этих событий сложно агрегировать в силу их сложной структуры (особенно категориальные и текстовые признаки), возникает проблема использования накопленных данных для прогнозирования таких событий. Таким образом перед непосредственно прогнозированием возникает задача специального представления этих событий, обладающего некоторым набором свойств. В этот набор в первую очередь входят интерпретируемость и возможность агрегации по времени. Одним из подходящих методов представления является преобразование исходных значений признаков в многомерный числовой ряд, так как задачи прогнозирования временных рядов широко изучены, а сами временные ряды обладают четкой структурой.

\subsection{Задача прогнозирования} \label{sect:event_forecast}
Задачей прогнозирования в общем случае является нахождение значений  переменной отклика в какой-то момент времени в будущем в зависимости от значений объясняющих переменных в предшествующие моменты времени.

Если рассматривать задачи прогнозирования событий, то среди них можно выделить 2 основных подхода:
\begin{itemize}
    \item \textbf{Определение вероятности наступления события}
        Необходимо предсказать вероятность $p$ наступления некоторого события в течение временного промежутка в будущем. Поскольку переменная отклика в этой задаче представляет собой вероятность наступления события, то ее возможные значения находятся в диапазоне от 0 до 1. 
        
    \item \textbf{Определение количества событий, которые произойдут}
        Необходимо предсказать количество $N_e$ событий с заданными характеристиками, которые произойдут в течение некоторого временного промежутка в будущем. Переменная отклика в данном случае является счетчиком событий, то есть принимает неотрицательные значения.
\end{itemize}

\subsection{Актуальность}
Поскольку в большинстве решаемых задач события обладают нерегулярной разнородной структурой и описываются как числовыми, так и категориальными, бинарными и текстовыми признаками, важно уметь использовать всю доступную информацию. Для того чтобы это было возможно, необходима разработка методов представления таких сложноструктурированных событий.  

Сама задача прогнозирования потоков в целом (включающая в себя как задачу прогнозирования вероятности, так и задачу прогнозирования количество событий) события также является чрезвычайно важной, поскольку область применения такого прогнозирования крайне широкая, в качестве нескольких примеров можно привести задачи прогнозирования цен акций, предсказания выхода оборудования из строя, оценки дорожного трафика в ближайшем будущем и определения вероятности перехода пользователя по некоторой ссылке.

Общие подходы, объединяющие решение этих двух задач вместе, не рассматривались в литературе, а разработка такого подхода позволит универсально решать задачу прогнозирования для любых сложных событий.